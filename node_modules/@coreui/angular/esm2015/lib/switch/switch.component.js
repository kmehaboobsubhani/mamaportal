import { Component, ElementRef, EventEmitter, HostBinding, HostListener, Input, Output, Renderer2 } from '@angular/core';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';
export class SwitchComponent {
    constructor(renderer, hostElement) {
        this.renderer = renderer;
        this.hostElement = hostElement;
        this.variant = '';
        this.labelOn = '';
        this.labelOff = '';
        this.size = '';
        this.shape = '';
        this.tabindex = '0';
        this.type = 'checkbox';
        this.value = 'on';
        this.data = {};
        this._props = {
            autofocus: false,
            checked: false,
            disabled: false,
            required: false,
        };
        this.hostTabIndex = -1;
        this.toggle = new EventEmitter();
        this.classes = {};
        this.host = this.hostElement.nativeElement;
    }
    get label() {
        return !!this.labelOn || !!this.labelOff;
    }
    set autofocus(value) {
        this._props.autofocus = typeof value === 'string' || !!value;
    }
    get autofocus() {
        return this._props.autofocus;
    }
    set checked(value) {
        this._props.checked = typeof value === 'string' || !!value;
    }
    get checked() {
        return this._props.checked;
    }
    set disabled(value) {
        this._props.disabled = typeof value === 'string' || !!value;
        this.tabindex = this._props.disabled ? -1 : this.tabindex;
    }
    get disabled() {
        return this._props.disabled;
    }
    set required(value) {
        this._props.required = typeof value === 'string' || !!value;
    }
    get required() {
        return this._props.required;
    }
    ngOnInit() {
        this.data = {
            'data-checked': this.labelOn,
            'data-unchecked': this.labelOff
        };
        this.setClasses();
    }
    setClasses() {
        const variant = this.variant ? `-${this.variant}` : '';
        this.classes['c-switch'] = true;
        this.classes['form-check-label'] = true;
        this.classes[`c-switch-${this.size}`] = !!this.size;
        this.classes[`c-switch-${this.shape}`] = !!this.shape;
        this.classes[`c-switch${variant}-${this.color}`] = !!this.color;
        this.classes['c-switch-label'] = !!this.label || typeof this.label === 'string';
    }
    ngOnChanges(changes) {
        if (changes.color) {
            this.classes[`c-switch-${changes.color.previousValue}`] = false;
        }
        if (changes.size) {
            this.classes[`c-switch-${changes.size.previousValue}`] = false;
        }
        if (changes.variant) {
            this.classes[`c-switch-variant-${changes.variant.previousValue}-alt`] = false;
            this.classes[`c-switch-variant-${changes.variant.previousValue}`] = false;
        }
        if (changes.shape) {
            this.classes[`c-switch-${changes.shape.previousValue}`] = false;
        }
        this.setClasses();
    }
    onKeyDown(e) {
        if (e.code === 'Space' && e.target === this.host.firstChild) {
            e.stopImmediatePropagation();
            e.stopPropagation();
            e.preventDefault();
        }
    }
    onKeyUp(e) {
        if (e.key === 'Enter') {
            this.toggleSwitch();
        }
    }
    onClick(e) {
        if (e.target.tagName === 'INPUT') {
            if (e instanceof MouseEvent) {
                this.toggleSwitch();
            }
        }
    }
    toggleSwitch() {
        if (this.disabled) {
            return false;
        }
        this.checked = !this.checked;
        this.toggle.emit(this);
    }
}
SwitchComponent.ɵfac = function SwitchComponent_Factory(t) { return new (t || SwitchComponent)(ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef)); };
SwitchComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: SwitchComponent, selectors: [["c-switch"]], hostVars: 1, hostBindings: function SwitchComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("keydown", function SwitchComponent_keydown_HostBindingHandler($event) { return ctx.onKeyDown($event); })("keyup", function SwitchComponent_keyup_HostBindingHandler($event) { return ctx.onKeyUp($event); })("click", function SwitchComponent_click_HostBindingHandler($event) { return ctx.onClick($event); });
    } if (rf & 2) {
        ɵngcc0.ɵɵattribute("tabindex", ctx.hostTabIndex);
    } }, inputs: { variant: "variant", labelOn: "labelOn", labelOff: "labelOff", size: "size", shape: "shape", tabindex: "tabindex", type: "type", value: "value", autofocus: "autofocus", checked: "checked", disabled: "disabled", required: "required", color: "color", name: "name" }, outputs: { toggle: "checked" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 3, vars: 12, consts: [[3, "ngClass", "tabindex"], [1, "c-switch-input", "form-check-input", 3, "tabindex", "type", "autofocus", "checked", "disabled", "required", "name", "value"], [1, "c-switch-slider"]], template: function SwitchComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵelementStart(0, "label", 0);
        ɵngcc0.ɵɵelement(1, "input", 1);
        ɵngcc0.ɵɵelement(2, "span", 2);
        ɵngcc0.ɵɵelementEnd();
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngClass", ctx.classes)("tabindex", -1);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("tabindex", ctx.tabindex)("type", ctx.type)("autofocus", ctx.autofocus)("checked", ctx.checked)("disabled", ctx.disabled)("required", ctx.required)("name", ctx.name ? ctx.name : "")("value", ctx.value);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵattribute("data-checked", ctx.labelOn)("data-unchecked", ctx.labelOff);
    } }, directives: [ɵngcc1.NgClass], styles: ["[_nghost-%COMP%]{outline:0}[_nghost-%COMP%], [_nghost-%COMP%]   .c-switch[_ngcontent-%COMP%], [_nghost-%COMP%]   .c-switch-input[_ngcontent-%COMP%], [_nghost-%COMP%]   .c-switch-slider[_ngcontent-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[_nghost-%COMP%]   .c-switch-label[_ngcontent-%COMP%]:focus{outline:0}.c-switch[_ngcontent-%COMP%]:focus{outline-style:auto;outline-offset:1px}.c-switch-slider[_ngcontent-%COMP%]:focus, .c-switch[_ngcontent-%COMP%]:hover{outline:none}"] });
SwitchComponent.ctorParameters = () => [
    { type: Renderer2 },
    { type: ElementRef }
];
SwitchComponent.propDecorators = {
    color: [{ type: Input }],
    variant: [{ type: Input }],
    labelOn: [{ type: Input }],
    labelOff: [{ type: Input }],
    size: [{ type: Input }],
    shape: [{ type: Input }],
    name: [{ type: Input }],
    tabindex: [{ type: Input }],
    type: [{ type: Input }],
    value: [{ type: Input }],
    autofocus: [{ type: Input }],
    checked: [{ type: Input }],
    disabled: [{ type: Input }],
    required: [{ type: Input }],
    hostTabIndex: [{ type: HostBinding, args: ['attr.tabindex',] }],
    toggle: [{ type: Output, args: ['checked',] }],
    onKeyDown: [{ type: HostListener, args: ['keydown', ['$event'],] }],
    onKeyUp: [{ type: HostListener, args: ['keyup', ['$event'],] }],
    onClick: [{ type: HostListener, args: ['click', ['$event'],] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SwitchComponent, [{
        type: Component,
        args: [{
                selector: 'c-switch',
                template: "<label [ngClass]=\"classes\" [tabindex]=\"-1\">\n  <input\n    class=\"c-switch-input form-check-input\"\n    [tabindex]=\"tabindex\"\n    [type]=\"type\"\n    [autofocus]=\"autofocus\"\n    [checked]=\"checked\"\n    [disabled]=\"disabled\"\n    [required]=\"required\"\n    [name]=\"name ? name : ''\"\n    [value]=\"value\">\n  <span class=\"c-switch-slider\" attr.data-checked=\"{{labelOn}}\" attr.data-unchecked=\"{{labelOff}}\"></span>\n</label>\n",
                styles: [":host{outline:0}:host,:host .c-switch,:host .c-switch-input,:host .c-switch-slider{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host .c-switch-label:focus{outline:0}.c-switch:focus{outline-style:auto;outline-offset:1px}.c-switch-slider:focus,.c-switch:hover{outline:none}"]
            }]
    }], function () { return [{ type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }]; }, { variant: [{
            type: Input
        }], labelOn: [{
            type: Input
        }], labelOff: [{
            type: Input
        }], size: [{
            type: Input
        }], shape: [{
            type: Input
        }], tabindex: [{
            type: Input
        }], type: [{
            type: Input
        }], value: [{
            type: Input
        }], hostTabIndex: [{
            type: HostBinding,
            args: ['attr.tabindex']
        }], toggle: [{
            type: Output,
            args: ['checked']
        }], autofocus: [{
            type: Input
        }], checked: [{
            type: Input
        }], disabled: [{
            type: Input
        }], required: [{
            type: Input
        }], onKeyDown: [{
            type: HostListener,
            args: ['keydown', ['$event']]
        }], onKeyUp: [{
            type: HostListener,
            args: ['keyup', ['$event']]
        }], onClick: [{
            type: HostListener,
            args: ['click', ['$event']]
        }], color: [{
            type: Input
        }], name: [{
            type: Input
        }] }); })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dpdGNoLmNvbXBvbmVudC5qcyIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvY29yZXVpLWFuZ3VsYXIvc3JjL2xpYi9zd2l0Y2gvc3dpdGNoLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULFVBQVUsRUFDVixZQUFZLEVBQUUsV0FBVyxFQUN6QixZQUFZLEVBQ1osS0FBSyxFQUdMLE1BQU0sRUFDTixTQUFTLEVBRVYsTUFBTSxlQUFlLENBQUM7OztBQU92QixNQUFNLE9BQU8sZUFBZTtBQUFJLElBbUU5QixZQUNVLFFBQW1CLEVBQ25CLFdBQXVCO0FBQ2hDLFFBRlMsYUFBUSxHQUFSLFFBQVEsQ0FBVztBQUMvQixRQUFZLGdCQUFXLEdBQVgsV0FBVyxDQUFZO0FBQ25DLFFBbkVXLFlBQU8sR0FBdUMsRUFBRSxDQUFDO0FBQzNELFFBQVUsWUFBTyxHQUEwQixFQUFFLENBQUU7QUFDL0MsUUFBVSxhQUFRLEdBQTBCLEVBQUUsQ0FBRTtBQUNoRCxRQUFVLFNBQUksR0FBcUIsRUFBRSxDQUFDO0FBQ3RDLFFBQVUsVUFBSyxHQUEyQixFQUFFLENBQUM7QUFFOUMsUUFDVyxhQUFRLEdBQW9CLEdBQUcsQ0FBQztBQUMxQyxRQUFVLFNBQUksR0FBeUIsVUFBVSxDQUFDO0FBQ2xELFFBQVUsVUFBSyxHQUFRLElBQUksQ0FBQztBQUU3QixRQUFFLFNBQUksR0FBRyxFQUFFLENBQUM7QUFFWixRQUlZLFdBQU0sR0FBRztBQUNwQixZQUFHLFNBQVMsRUFBRSxLQUFLO0FBQ25CLFlBQUcsT0FBTyxFQUFFLEtBQUs7QUFDakIsWUFBRyxRQUFRLEVBQUUsS0FBSztBQUNsQixZQUFHLFFBQVEsRUFBRSxLQUFLO0FBQ2xCLFNBQUUsQ0FBQztBQUVKLFFBaUNnQyxpQkFBWSxHQUFHLENBQUMsQ0FBQyxDQUFDO0FBRWxELFFBQXFCLFdBQU0sR0FBRyxJQUFJLFlBQVksRUFBbUIsQ0FBQztBQUVsRSxR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QUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFNQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFtQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBTUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUF4REEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFTQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQWdCQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUNBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUE5SUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBRUEsQUFSQSxBQUFBLEFBUEEsQUFBQSxBQWtCQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFDQSxBQUFBLEFBZUEsQUFBQSxBQVFBLEFBQUEsQUFRQSxBQUFBLEFBU0EsQUFBQSxBQVFBLEFBQUEsQUFBQSxBQUFBLEFBRUEsQUFBQSxBQUFBLEFBQUEsQUFnREEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQU9BLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFLQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsIEhvc3RCaW5kaW5nLFxuICBIb3N0TGlzdGVuZXIsXG4gIElucHV0LFxuICBPbkNoYW5nZXMsXG4gIE9uSW5pdCxcbiAgT3V0cHV0LFxuICBSZW5kZXJlcjIsXG4gIFNpbXBsZUNoYW5nZXNcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2Mtc3dpdGNoJyxcbiAgdGVtcGxhdGVVcmw6ICcuL3N3aXRjaC5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL3N3aXRjaC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFN3aXRjaENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25DaGFuZ2VzIHtcblxuICBASW5wdXQoKSBjb2xvcjogc3RyaW5nO1xuICBASW5wdXQoKSB2YXJpYW50OiAnJyB8ICdvdXRsaW5lJyB8ICdvcHBvc2l0ZScgfCAnM2QnID0gJyc7XG4gIEBJbnB1dCgpIGxhYmVsT246IHN0cmluZyB8ICdvbicgfCAneWVzJyA9ICcnIDtcbiAgQElucHV0KCkgbGFiZWxPZmY6IHN0cmluZyB8ICdvZmYnIHwgJ25vJyA9ICcnIDtcbiAgQElucHV0KCkgc2l6ZTogJycgfCAnc20nIHwgJ2xnJyA9ICcnO1xuICBASW5wdXQoKSBzaGFwZTogJycgfCAncGlsbCcgfCAnc3F1YXJlJyA9ICcnO1xuXG4gIEBJbnB1dCgpIG5hbWU6IHN0cmluZztcbiAgQElucHV0KCkgdGFiaW5kZXg6IG51bWJlciB8IHN0cmluZyA9ICcwJztcbiAgQElucHV0KCkgdHlwZTogJ2NoZWNrYm94JyB8ICdyYWRpbycgPSAnY2hlY2tib3gnO1xuICBASW5wdXQoKSB2YWx1ZTogYW55ID0gJ29uJztcblxuICBkYXRhID0ge307XG5cbiAgcHJpdmF0ZSBnZXQgbGFiZWwoKSB7XG4gICAgcmV0dXJuICEhdGhpcy5sYWJlbE9uIHx8ICEhdGhpcy5sYWJlbE9mZjtcbiAgfVxuXG4gIHByb3RlY3RlZCBfcHJvcHMgPSB7XG4gICAgYXV0b2ZvY3VzOiBmYWxzZSxcbiAgICBjaGVja2VkOiBmYWxzZSxcbiAgICBkaXNhYmxlZDogZmFsc2UsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICB9O1xuXG4gIEBJbnB1dCgpXG4gIHNldCBhdXRvZm9jdXModmFsdWUpIHtcbiAgICB0aGlzLl9wcm9wcy5hdXRvZm9jdXMgPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8ICEhdmFsdWU7XG4gIH1cbiAgZ2V0IGF1dG9mb2N1cygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvcHMuYXV0b2ZvY3VzO1xuICB9XG5cbiAgQElucHV0KClcbiAgc2V0IGNoZWNrZWQodmFsdWUpIHtcbiAgICB0aGlzLl9wcm9wcy5jaGVja2VkID0gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCAhIXZhbHVlO1xuICB9XG4gIGdldCBjaGVja2VkKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9wcm9wcy5jaGVja2VkO1xuICB9XG5cbiAgQElucHV0KClcbiAgc2V0IGRpc2FibGVkKHZhbHVlKSB7XG4gICAgdGhpcy5fcHJvcHMuZGlzYWJsZWQgPSB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8ICEhdmFsdWU7XG4gICAgdGhpcy50YWJpbmRleCA9IHRoaXMuX3Byb3BzLmRpc2FibGVkID8gLTEgOiB0aGlzLnRhYmluZGV4O1xuICB9XG4gIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fcHJvcHMuZGlzYWJsZWQ7XG4gIH1cblxuICBASW5wdXQoKVxuICBzZXQgcmVxdWlyZWQodmFsdWUpIHtcbiAgICB0aGlzLl9wcm9wcy5yZXF1aXJlZCA9IHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgISF2YWx1ZTtcbiAgfVxuICBnZXQgcmVxdWlyZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Byb3BzLnJlcXVpcmVkO1xuICB9XG5cbiAgQEhvc3RCaW5kaW5nKCdhdHRyLnRhYmluZGV4JykgaG9zdFRhYkluZGV4ID0gLTE7XG5cbiAgQE91dHB1dCgnY2hlY2tlZCcpIHRvZ2dsZSA9IG5ldyBFdmVudEVtaXR0ZXI8U3dpdGNoQ29tcG9uZW50PigpO1xuXG4gIHByaXZhdGUgcmVhZG9ubHkgaG9zdDogSFRNTEVsZW1lbnQ7XG4gIGNsYXNzZXMgPSB7fTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgcHJpdmF0ZSBob3N0RWxlbWVudDogRWxlbWVudFJlZixcbiAgKSB7XG4gICAgdGhpcy5ob3N0ID0gdGhpcy5ob3N0RWxlbWVudC5uYXRpdmVFbGVtZW50O1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5kYXRhID0ge1xuICAgICAgJ2RhdGEtY2hlY2tlZCc6IHRoaXMubGFiZWxPbixcbiAgICAgICdkYXRhLXVuY2hlY2tlZCc6IHRoaXMubGFiZWxPZmZcbiAgICB9O1xuICAgIHRoaXMuc2V0Q2xhc3NlcygpO1xuICB9XG5cbiAgc2V0Q2xhc3NlcygpIHtcbiAgICBjb25zdCB2YXJpYW50ID0gdGhpcy52YXJpYW50ID8gYC0ke3RoaXMudmFyaWFudH1gIDogJyc7XG5cbiAgICB0aGlzLmNsYXNzZXNbJ2Mtc3dpdGNoJ10gPSB0cnVlO1xuICAgIHRoaXMuY2xhc3Nlc1snZm9ybS1jaGVjay1sYWJlbCddID0gdHJ1ZTtcbiAgICB0aGlzLmNsYXNzZXNbYGMtc3dpdGNoLSR7dGhpcy5zaXplfWBdID0gISF0aGlzLnNpemU7XG4gICAgdGhpcy5jbGFzc2VzW2BjLXN3aXRjaC0ke3RoaXMuc2hhcGV9YF0gPSAhIXRoaXMuc2hhcGU7XG4gICAgdGhpcy5jbGFzc2VzW2BjLXN3aXRjaCR7dmFyaWFudH0tJHt0aGlzLmNvbG9yfWBdID0gISF0aGlzLmNvbG9yO1xuICAgIHRoaXMuY2xhc3Nlc1snYy1zd2l0Y2gtbGFiZWwnXSA9ICEhdGhpcy5sYWJlbCB8fCB0eXBlb2YgdGhpcy5sYWJlbCA9PT0gJ3N0cmluZyc7XG4gIH1cblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKSB7XG4gICAgaWYgKGNoYW5nZXMuY29sb3IpIHtcbiAgICAgIHRoaXMuY2xhc3Nlc1tgYy1zd2l0Y2gtJHtjaGFuZ2VzLmNvbG9yLnByZXZpb3VzVmFsdWV9YF0gPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXMuc2l6ZSkge1xuICAgICAgdGhpcy5jbGFzc2VzW2BjLXN3aXRjaC0ke2NoYW5nZXMuc2l6ZS5wcmV2aW91c1ZhbHVlfWBdID0gZmFsc2U7XG4gICAgfVxuICAgIGlmIChjaGFuZ2VzLnZhcmlhbnQpIHtcbiAgICAgIHRoaXMuY2xhc3Nlc1tgYy1zd2l0Y2gtdmFyaWFudC0ke2NoYW5nZXMudmFyaWFudC5wcmV2aW91c1ZhbHVlfS1hbHRgXSA9IGZhbHNlO1xuICAgICAgdGhpcy5jbGFzc2VzW2BjLXN3aXRjaC12YXJpYW50LSR7Y2hhbmdlcy52YXJpYW50LnByZXZpb3VzVmFsdWV9YF0gPSBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGNoYW5nZXMuc2hhcGUpIHtcbiAgICAgIHRoaXMuY2xhc3Nlc1tgYy1zd2l0Y2gtJHtjaGFuZ2VzLnNoYXBlLnByZXZpb3VzVmFsdWV9YF0gPSBmYWxzZTtcbiAgICB9XG4gICAgdGhpcy5zZXRDbGFzc2VzKCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdrZXlkb3duJywgWyckZXZlbnQnXSkgb25LZXlEb3duKGUpIHtcbiAgICBpZiAoZS5jb2RlID09PSAnU3BhY2UnICYmIGUudGFyZ2V0ID09PSB0aGlzLmhvc3QuZmlyc3RDaGlsZCkge1xuICAgICAgZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9XG4gIEBIb3N0TGlzdGVuZXIoJ2tleXVwJywgWyckZXZlbnQnXSkgb25LZXlVcChlKSB7XG4gICAgaWYgKGUua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICB0aGlzLnRvZ2dsZVN3aXRjaCgpO1xuICAgIH1cbiAgfVxuICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pIG9uQ2xpY2soZSkge1xuICAgIGlmICggZS50YXJnZXQudGFnTmFtZSA9PT0gJ0lOUFVUJykge1xuICAgICAgaWYgKGUgaW5zdGFuY2VvZiBNb3VzZUV2ZW50KSB7XG4gICAgICAgIHRoaXMudG9nZ2xlU3dpdGNoKCk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgdG9nZ2xlU3dpdGNoKCkge1xuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHRoaXMuY2hlY2tlZCA9ICF0aGlzLmNoZWNrZWQ7XG4gICAgdGhpcy50b2dnbGUuZW1pdCh0aGlzKTtcbiAgICAvLyB0aGlzLnRvZ2dsZS5lbWl0KHRoaXMuY2hlY2tlZCk7XG4gIH1cbn1cbiJdfQ==