import { Component, ContentChild, ElementRef, ChangeDetectorRef, Input, HostListener, Renderer2, Inject, } from '@angular/core';
import { DOCUMENT } from '@angular/common';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

const _c0 = ["modalHeader"];
const _c1 = ["modalBody"];
const _c2 = ["modalFooter"];
function ModalComponent_div_0_ng_container_4_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0, 11);
} }
function ModalComponent_div_0_ng_container_8_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function ModalComponent_div_0_ng_container_10_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementContainer(0);
} }
function ModalComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    const _r6 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 2);
    ɵngcc0.ɵɵelementStart(1, "div", 3);
    ɵngcc0.ɵɵelementStart(2, "div", 4);
    ɵngcc0.ɵɵelementStart(3, "div", 5);
    ɵngcc0.ɵɵtemplate(4, ModalComponent_div_0_ng_container_4_Template, 1, 0, "ng-container", 6);
    ɵngcc0.ɵɵelementStart(5, "button", 7);
    ɵngcc0.ɵɵlistener("click", function ModalComponent_div_0_Template_button_click_5_listener() { ɵngcc0.ɵɵrestoreView(_r6); const ctx_r5 = ɵngcc0.ɵɵnextContext(); return ctx_r5.hide(); });
    ɵngcc0.ɵɵtext(6, "\u00D7");
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(7, "div", 8);
    ɵngcc0.ɵɵtemplate(8, ModalComponent_div_0_ng_container_8_Template, 1, 0, "ng-container", 9);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(9, "div", 10);
    ɵngcc0.ɵɵtemplate(10, ModalComponent_div_0_ng_container_10_Template, 1, 0, "ng-container", 9);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵclassProp("show", ctx_r0.visibleAnimate);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r0.modalClasses);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ctx_r0.dialogClasses);
    ɵngcc0.ɵɵadvance(3);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r0.header);
    ɵngcc0.ɵɵadvance(4);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r0.body);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵproperty("ngTemplateOutlet", ctx_r0.footer);
} }
function ModalComponent_div_1_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "div", 12);
} if (rf & 2) {
    const ctx_r1 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("ngClass", ctx_r1.backdropClasses);
} }
export class ModalComponent {
    constructor(document, renderer, elementRef, changeDetectorRef) {
        this.document = document;
        this.renderer = renderer;
        this.elementRef = elementRef;
        this.changeDetectorRef = changeDetectorRef;
        this.closeOnBackdrop = true;
        this.size = '';
        this.color = '';
        this.modalClasses = {
            modal: true,
            fade: true
        };
        this.dialogClasses = {
            'modal-dialog': true
        };
        this.backdropClasses = {
            'modal-backdrop': true,
            fade: true,
            show: true
        };
        this.visible = false;
        this.visibleAnimate = false;
    }
    ngOnInit() {
        this.setClasses();
    }
    ngOnDestroy() {
        this.hide();
    }
    setClasses() {
        this.dialogClasses[`modal-${this.size}`] = !!this.size;
        this.dialogClasses[`modal-${this.color}`] = !!this.color;
    }
    show() {
        this.renderer.addClass(this.document.body, 'modal-open');
        this.visible = true;
        this.modalClasses[`d-block`] = true;
        setTimeout(() => {
            this.visibleAnimate = true;
        });
    }
    hide() {
        this.renderer.removeClass(this.document.body, 'modal-open');
        this.visibleAnimate = false;
        setTimeout(() => {
            this.visible = false;
            this.modalClasses[`d-block`] = false;
            this.changeDetectorRef.markForCheck();
        }, 200);
    }
    onContainerClicked(event) {
        if (event.target.classList.contains('modal') && this.isTopmost() && this.closeOnBackdrop) {
            this.hide();
        }
    }
    onKeyDownHandler(event) {
        if (event.key === 'Escape' && this.isTopmost()) {
            this.hide();
        }
    }
    isTopmost() {
        const isTopmost = !this.elementRef.nativeElement.querySelector(':scope c-modal > .modal');
        return isTopmost;
    }
}
ModalComponent.ɵfac = function ModalComponent_Factory(t) { return new (t || ModalComponent)(ɵngcc0.ɵɵdirectiveInject(DOCUMENT), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.Renderer2), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ElementRef), ɵngcc0.ɵɵdirectiveInject(ɵngcc0.ChangeDetectorRef)); };
ModalComponent.ɵcmp = ɵngcc0.ɵɵdefineComponent({ type: ModalComponent, selectors: [["c-modal"]], contentQueries: function ModalComponent_ContentQueries(rf, ctx, dirIndex) { if (rf & 1) {
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c0, 3);
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c1, 3);
        ɵngcc0.ɵɵcontentQuery(dirIndex, _c2, 3);
    } if (rf & 2) {
        let _t;
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.header = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.body = _t.first);
        ɵngcc0.ɵɵqueryRefresh(_t = ɵngcc0.ɵɵloadQuery()) && (ctx.footer = _t.first);
    } }, hostBindings: function ModalComponent_HostBindings(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵlistener("click", function ModalComponent_click_HostBindingHandler($event) { return ctx.onContainerClicked($event); })("keydown", function ModalComponent_keydown_HostBindingHandler($event) { return ctx.onKeyDownHandler($event); }, false, ɵngcc0.ɵɵresolveDocument);
    } }, inputs: { closeOnBackdrop: "closeOnBackdrop", size: "size", color: "color" }, decls: 2, vars: 2, consts: [["role", "dialog", "tabindex", "-1", 3, "show", "ngClass", 4, "ngIf"], [3, "ngClass", 4, "ngIf"], ["role", "dialog", "tabindex", "-1", 3, "ngClass"], ["role", "document", 3, "ngClass"], [1, "modal-content"], [1, "modal-header"], ["class", "modal-title", 4, "ngTemplateOutlet"], ["data-dismiss", "modal", "type", "button", "aria-label", "Close", 1, "close", 3, "click"], [1, "modal-body"], [4, "ngTemplateOutlet"], [1, "modal-footer"], [1, "modal-title"], [3, "ngClass"]], template: function ModalComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, ModalComponent_div_0_Template, 11, 7, "div", 0);
        ɵngcc0.ɵɵtemplate(1, ModalComponent_div_1_Template, 1, 1, "div", 1);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.visible);
        ɵngcc0.ɵɵadvance(1);
        ɵngcc0.ɵɵproperty("ngIf", ctx.visibleAnimate);
    } }, directives: [ɵngcc1.NgIf, ɵngcc1.NgClass, ɵngcc1.NgTemplateOutlet], styles: [""] });
ModalComponent.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: [DOCUMENT,] }] },
    { type: Renderer2 },
    { type: ElementRef },
    { type: ChangeDetectorRef }
];
ModalComponent.propDecorators = {
    header: [{ type: ContentChild, args: ['modalHeader', { static: true },] }],
    body: [{ type: ContentChild, args: ['modalBody', { static: true },] }],
    footer: [{ type: ContentChild, args: ['modalFooter', { static: true },] }],
    closeOnBackdrop: [{ type: Input }],
    size: [{ type: Input }],
    color: [{ type: Input }],
    onContainerClicked: [{ type: HostListener, args: ['click', ['$event'],] }],
    onKeyDownHandler: [{ type: HostListener, args: ['document:keydown', ['$event'],] }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(ModalComponent, [{
        type: Component,
        args: [{
                selector: 'c-modal',
                template: "<div\n  role=\"dialog\"\n  tabindex=\"-1\"\n  [class.show]=\"visibleAnimate\"\n  [ngClass]=\"modalClasses\"\n  *ngIf=\"visible\">\n  <div [ngClass]=\"dialogClasses\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <ng-container *ngTemplateOutlet=\"header\" class=\"modal-title\"></ng-container>\n        <button class=\"close\" data-dismiss=\"modal\" type=\"button\" aria-label=\"Close\" (click)=\"hide()\">\u00D7</button>\n      </div>\n      <div class=\"modal-body\">\n        <ng-container *ngTemplateOutlet=\"body\"></ng-container>\n      </div>\n      <div class=\"modal-footer\">\n        <ng-container *ngTemplateOutlet=\"footer\"></ng-container>\n      </div>\n    </div>\n  </div>\n</div>\n<div\n  *ngIf=\"visibleAnimate\"\n  [ngClass]=\"backdropClasses\">\n</div>\n",
                styles: [""]
            }]
    }], function () { return [{ type: undefined, decorators: [{
                type: Inject,
                args: [DOCUMENT]
            }] }, { type: ɵngcc0.Renderer2 }, { type: ɵngcc0.ElementRef }, { type: ɵngcc0.ChangeDetectorRef }]; }, { closeOnBackdrop: [{
            type: Input
        }], size: [{
            type: Input
        }], color: [{
            type: Input
        }], onContainerClicked: [{
            type: HostListener,
            args: ['click', ['$event']]
        }], onKeyDownHandler: [{
            type: HostListener,
            args: ['document:keydown', ['$event']]
        }], header: [{
            type: ContentChild,
            args: ['modalHeader', { static: true }]
        }], body: [{
            type: ContentChild,
            args: ['modalBody', { static: true }]
        }], footer: [{
            type: ContentChild,
            args: ['modalFooter', { static: true }]
        }] }); })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9kYWwuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9wcm9qZWN0cy9jb3JldWktYW5ndWxhci9zcmMvbGliL21vZGFsL21vZGFsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUVULFlBQVksRUFDWixVQUFVLEVBR1YsaUJBQWlCLEVBQ2pCLEtBQUssRUFDTCxZQUFZLEVBQVUsU0FBUyxFQUFFLE1BQU0sR0FDeEMsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLGlCQUFpQixDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQU96QyxNQUFNLE9BQU8sY0FBYztBQUFJLElBdUI3QixZQUM0QixRQUFhLEVBQy9CLFFBQW1CLEVBQ25CLFVBQXNCLEVBQ3RCLGlCQUFvQztBQUM1QyxRQUowQixhQUFRLEdBQVIsUUFBUSxDQUFLO0FBQzNDLFFBQVksYUFBUSxHQUFSLFFBQVEsQ0FBVztBQUMvQixRQUFZLGVBQVUsR0FBVixVQUFVLENBQVk7QUFDbEMsUUFBWSxzQkFBaUIsR0FBakIsaUJBQWlCLENBQW1CO0FBQy9DLFFBeEJVLG9CQUFlLEdBQUcsSUFBSSxDQUFDO0FBQ2pDLFFBQVUsU0FBSSxHQUE0QixFQUFFLENBQUM7QUFDN0MsUUFBVSxVQUFLLEdBQUcsRUFBRSxDQUFDO0FBRXRCLFFBQUUsaUJBQVksR0FBRztBQUNoQixZQUFHLEtBQUssRUFBRSxJQUFJO0FBQ2QsWUFBRyxJQUFJLEVBQUUsSUFBSTtBQUNiLFNBQUUsQ0FBQztBQUNILFFBQUMsa0JBQWEsR0FBRztBQUNqQixZQUFHLGNBQWMsRUFBRSxJQUFJO0FBQ3ZCLFNBQUUsQ0FBQztBQUNILFFBQUMsb0JBQWUsR0FBRztBQUNuQixZQUFHLGdCQUFnQixFQUFFLElBQUk7QUFDekIsWUFBRyxJQUFJLEVBQUUsSUFBSTtBQUNi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QUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBT0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUVBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUVBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFHQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFDQSxBQUFBLEFBR0EsQUFBQSxBQUFBLEFBQUEsQUFFQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQ0EsQUFBQSxBQUtBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQXpGQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFFQSxBQXlCQSxBQUFBLEFBQUEsQUFBQSxBQWpDQSxBQUFBLEFBTEEsQUFBQSxBQUdBLEFBQUEsQUFZQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUNBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQ0EsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFDQSxBQUFBLEFBQ0EsQUFBQSxBQUNBLEFBQUEsQUF5REEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQU9BLEFBQUEsQUFBQSxBQUFBLEFBQUEsQUFBQSxBQUFBLEFBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIE9uRGVzdHJveSxcbiAgQ29udGVudENoaWxkLFxuICBFbGVtZW50UmVmLFxuICBUZW1wbGF0ZVJlZixcbiAgLy8gQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gIENoYW5nZURldGVjdG9yUmVmLFxuICBJbnB1dCxcbiAgSG9zdExpc3RlbmVyLCBPbkluaXQsIFJlbmRlcmVyMiwgSW5qZWN0LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7RE9DVU1FTlR9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbic7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2MtbW9kYWwnLFxuICB0ZW1wbGF0ZVVybDogJy4vbW9kYWwuY29tcG9uZW50Lmh0bWwnLFxuICBzdHlsZVVybHM6IFsnLi9tb2RhbC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIE1vZGFsQ29tcG9uZW50IGltcGxlbWVudHMgT25EZXN0cm95LCBPbkluaXQge1xuICBAQ29udGVudENoaWxkKCdtb2RhbEhlYWRlcicsIHtzdGF0aWM6IHRydWV9KSBoZWFkZXI6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBDb250ZW50Q2hpbGQoJ21vZGFsQm9keScsIHtzdGF0aWM6IHRydWV9KSBib2R5OiBUZW1wbGF0ZVJlZjxhbnk+O1xuICBAQ29udGVudENoaWxkKCdtb2RhbEZvb3RlcicsIHtzdGF0aWM6IHRydWV9KSBmb290ZXI6IFRlbXBsYXRlUmVmPGFueT47XG4gIEBJbnB1dCgpIGNsb3NlT25CYWNrZHJvcCA9IHRydWU7XG4gIEBJbnB1dCgpIHNpemU6ICdzbScgfCAnJyB8ICdsZycgfCAneGwnID0gJyc7XG4gIEBJbnB1dCgpIGNvbG9yID0gJyc7XG5cbiAgbW9kYWxDbGFzc2VzID0ge1xuICAgIG1vZGFsOiB0cnVlLFxuICAgIGZhZGU6IHRydWVcbiAgfTtcbiAgZGlhbG9nQ2xhc3NlcyA9IHtcbiAgICAnbW9kYWwtZGlhbG9nJzogdHJ1ZVxuICB9O1xuICBiYWNrZHJvcENsYXNzZXMgPSB7XG4gICAgJ21vZGFsLWJhY2tkcm9wJzogdHJ1ZSxcbiAgICBmYWRlOiB0cnVlLFxuICAgIHNob3c6IHRydWVcbiAgfTtcbiAgdmlzaWJsZSA9IGZhbHNlO1xuICB2aXNpYmxlQW5pbWF0ZSA9IGZhbHNlO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoRE9DVU1FTlQpIHByaXZhdGUgZG9jdW1lbnQ6IGFueSxcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjIsXG4gICAgcHJpdmF0ZSBlbGVtZW50UmVmOiBFbGVtZW50UmVmLFxuICAgIHByaXZhdGUgY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmXG4gICkgeyB9XG5cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5zZXRDbGFzc2VzKCk7XG4gIH1cbiAgbmdPbkRlc3Ryb3koKSB7XG4gICAgdGhpcy5oaWRlKCk7XG4gIH1cblxuICBzZXRDbGFzc2VzKCkge1xuICAgIHRoaXMuZGlhbG9nQ2xhc3Nlc1tgbW9kYWwtJHt0aGlzLnNpemV9YF0gPSAhIXRoaXMuc2l6ZTtcbiAgICB0aGlzLmRpYWxvZ0NsYXNzZXNbYG1vZGFsLSR7dGhpcy5jb2xvcn1gXSA9ICEhdGhpcy5jb2xvcjtcbiAgfVxuXG4gIHNob3coKTogdm9pZCB7XG4gICAgdGhpcy5yZW5kZXJlci5hZGRDbGFzcyh0aGlzLmRvY3VtZW50LmJvZHksICdtb2RhbC1vcGVuJyk7XG5cbiAgICB0aGlzLnZpc2libGUgPSB0cnVlO1xuICAgIHRoaXMubW9kYWxDbGFzc2VzW2BkLWJsb2NrYF0gPSB0cnVlO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy52aXNpYmxlQW5pbWF0ZSA9IHRydWU7XG4gICAgfSk7XG4gIH1cblxuICBoaWRlKCk6IHZvaWQge1xuICAgIHRoaXMucmVuZGVyZXIucmVtb3ZlQ2xhc3ModGhpcy5kb2N1bWVudC5ib2R5LCAnbW9kYWwtb3BlbicpO1xuXG4gICAgdGhpcy52aXNpYmxlQW5pbWF0ZSA9IGZhbHNlO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7XG4gICAgICB0aGlzLm1vZGFsQ2xhc3Nlc1tgZC1ibG9ja2BdID0gZmFsc2U7XG4gICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgIH0sIDIwMCk7XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCdjbGljaycsIFsnJGV2ZW50J10pXG4gIG9uQ29udGFpbmVyQ2xpY2tlZChldmVudDogTW91c2VFdmVudCk6IHZvaWQge1xuICAgIGlmICgoZXZlbnQudGFyZ2V0IGFzIEhUTUxFbGVtZW50KS5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsJykgJiYgdGhpcy5pc1RvcG1vc3QoKSAmJiB0aGlzLmNsb3NlT25CYWNrZHJvcCkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuICB9XG5cbiAgQEhvc3RMaXN0ZW5lcignZG9jdW1lbnQ6a2V5ZG93bicsIFsnJGV2ZW50J10pXG4gIG9uS2V5RG93bkhhbmRsZXIoZXZlbnQ6IEtleWJvYXJkRXZlbnQpIHtcbiAgICAvLyBJZiBFU0Mga2V5IGFuZCBUT1AgTU9TVCBtb2RhbCwgY2xvc2UgaXQuXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScgJiYgdGhpcy5pc1RvcG1vc3QoKSkge1xuICAgICAgdGhpcy5oaWRlKCk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdHJ1ZSBpZiB0aGlzIG1vZGFsIGlzIHRoZSB0b3AgbW9zdCBtb2RhbC5cbiAgICovXG4gIGlzVG9wbW9zdCgpOiBib29sZWFuIHtcbiAgICBjb25zdCBpc1RvcG1vc3QgPSAhdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignOnNjb3BlIGMtbW9kYWwgPiAubW9kYWwnKTtcbiAgICByZXR1cm4gaXNUb3Btb3N0O1xuICB9XG59XG4iXX0=